# 注意事项

## node里可以正常运行的包，到了electron 不能正常运行

- 安装使用 @electron/rebuild 

  ```shell
  pnpm i @electron/rebuild -D
  ```

- 运行 `npx electron-rebuild` 对第三放原生模块进行重新编译

  ```shell
  npx electron-rebuild
  ```

  

## 配置持久化存储

- 安装使用 electron-stroe

  ```shell
  pnpm i electron-store
  ```

- 创建文件使用, 会在exe同级录下创建以name命名的json文件

  ```typescript
  import Stroe from 'electron-store';
  
  export const StaticStore = new Stroe({
    name: 'base',
    // encryptionKey: 'b175f9ee4e6d7d2b1f08e585b227a27a61f6f101e741c3a0485ff9c0aef7e32c',
    schema: {open{type:'boolean',default:false}}
  });
  ```

  

## 后端服务nest.js 集成

- 安装使用 nest

  ```shell
  pnpm i @nestjs/common @nestjs/core @nestjs/platform-express rxjs
  ```

  `@nestjs/microservices` 是 nest 微服务模块

- 使用vite处理加载 ts 的时候，由于vite使用esbuild 所以不支持完整的装饰器功能 `reflect-metadata` 所以使用nest.js会有问题

  - 安装插件 单独处理nest @rollup/plugin-typescript

    ```typescript
    export default defineConfig({
         plugins: [
          typescript({  // nest 单独使用typescript编译器处理
            tsconfig: './tsconfig.node.json', //注意开启装饰器选项，和输出目录
            include: ['src/nest/**/*']
          })
        ],
        esbuild: {
          exclude: ['src/nest/**/*'] //esbuild 不处理 nest
        }
    })
    ```

    
